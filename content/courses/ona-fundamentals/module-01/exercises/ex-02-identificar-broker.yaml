# Ejercicio 2: Identificar broker en red de 3 departamentos
# Tipo: code-python (c칩digo oculto)

id: ex-02-identificar-broker
type: code-python
title: "Identificando al broker"
description: "Encuentra qui칠n conecta departamentos que de otra forma estar칤an aislados."

instructions: |
  La visualizaci칩n muestra una red de 3 departamentos (Producci칩n, Ventas, Log칤stica).

  Los colores indican el departamento de cada persona:
  - 游댯 Azul = Producci칩n
  - 游릭 Verde = Ventas
  - 游 Naranja = Log칤stica

  **Tu tarea**: Identifica al broker (la persona que conecta departamentos).

  Pista: El broker es alguien que tiene conexiones con personas de m칰ltiples departamentos.

difficulty: beginner
estimated_time_minutes: 5
points: 20
order: 2

required_packages:
  - networkx
  - matplotlib

ui_config:
  hide_code: true
  show_output_only: true
  interactive_mode: visualization

starter_code: |
  import networkx as nx
  import matplotlib.pyplot as plt

  # Red de 3 departamentos
  G = nx.Graph()

  # Departamento de Producci칩n (azul)
  prod_nodes = ["P1", "P2", "P3", "P4"]
  prod_edges = [("P1", "P2"), ("P2", "P3"), ("P3", "P4"), ("P1", "P3")]

  # Departamento de Ventas (verde)
  ventas_nodes = ["V1", "V2", "V3"]
  ventas_edges = [("V1", "V2"), ("V2", "V3"), ("V1", "V3")]

  # Departamento de Log칤stica (naranja)
  log_nodes = ["L1", "L2", "L3"]
  log_edges = [("L1", "L2"), ("L2", "L3")]

  # El BROKER que conecta todo
  broker = "Mar칤a"

  # Conexiones del broker (una con cada departamento)
  broker_edges = [("Mar칤a", "P2"), ("Mar칤a", "V1"), ("Mar칤a", "L2")]

  # Construir grafo
  G.add_nodes_from(prod_nodes + ventas_nodes + log_nodes + [broker])
  G.add_edges_from(prod_edges + ventas_edges + log_edges + broker_edges)

  # Colores por departamento
  color_map = []
  for node in G.nodes():
      if node.startswith("P"):
          color_map.append("#3498db")  # Azul - Producci칩n
      elif node.startswith("V"):
          color_map.append("#2ecc71")  # Verde - Ventas
      elif node.startswith("L"):
          color_map.append("#e67e22")  # Naranja - Log칤stica
      else:
          color_map.append("#e74c3c")  # Rojo - Broker

  plt.figure(figsize=(12, 8))
  pos = nx.spring_layout(G, k=2, seed=42)

  # Dibujar nodos
  nx.draw_networkx_nodes(G, pos, node_color=color_map, node_size=1500)
  nx.draw_networkx_labels(G, pos, font_size=10, font_weight='bold')
  nx.draw_networkx_edges(G, pos, edge_color='gray', alpha=0.6)

  plt.title("Red de 3 Departamentos\n쯈ui칠n es el broker?", fontsize=14, fontweight='bold')

  # Leyenda
  legend_elements = [
      plt.Line2D([0], [0], marker='o', color='w', markerfacecolor='#3498db',
                 markersize=15, label='Producci칩n'),
      plt.Line2D([0], [0], marker='o', color='w', markerfacecolor='#2ecc71',
                 markersize=15, label='Ventas'),
      plt.Line2D([0], [0], marker='o', color='w', markerfacecolor='#e67e22',
                 markersize=15, label='Log칤stica'),
      plt.Line2D([0], [0], marker='o', color='w', markerfacecolor='#e74c3c',
                 markersize=15, label='쮹roker?'),
  ]
  plt.legend(handles=legend_elements, loc='upper left')

  plt.axis('off')
  plt.tight_layout()
  plt.show()

  print("\n" + "="*50)
  print("PREGUNTA")
  print("="*50)
  print("\n쯈ui칠n es el broker en esta red?")
  print("\nOpciones:")
  print("A) P2 - porque tiene m치s conexiones en Producci칩n")
  print("B) Mar칤a - porque conecta los 3 departamentos")
  print("C) V1 - porque est치 en el centro del departamento de Ventas")
  print("D) L2 - porque conecta Log칤stica internamente")

solution_code: |
  # Respuesta correcta: B) Mar칤a
  # Mar칤a es el broker porque:
  # - Tiene conexiones con Producci칩n (P2), Ventas (V1) y Log칤stica (L2)
  # - Sin ella, los 3 departamentos quedar칤an desconectados
  # - Su intermediaci칩n (betweenness) es la m치s alta de la red

test_cases:
  - id: test-broker-identification
    name: "Identificaci칩n del broker"
    test_code: |
      assert True, "Broker identificado correctamente"
    points: 20

hints:
  - "El broker es el 칰nico nodo que conecta diferentes colores"
  - "Sin el broker, 쯟os departamentos podr칤an comunicarse?"
  - "Busca el nodo en ROJO - es diferente a los dem치s"

tags:
  - ona
  - broker
  - intermediacion
  - silos

concepts:
  - broker
  - intermediacion
  - conexion-entre-silos
